<template>
  <div id="app">
    <v-app id="inspire">
      <v-data-table
        class="elevation-1"
        fixed-header
        hide-default-footer
        show-select
        :headers="headers"
        :items="mockai"
      ></v-data-table>
    </v-app>
  </div>
</template>
<script>
import axios from 'axios';
export default {
  data() {
    return {
      headers: [
        { title: '코인', value: 'coin', align:'center'},
        { title: '평단가', value: 'price', align:'center'},
        { title: '남은 수량', value: 'amount', align:'center'},
        { title: '총 금액', value: 'total_price', align:'center'},
        { title: '최초 매수일자', value: 'sale_date', align:'center'},
        { title: '최종 매도일자', value: 'sell_date', align:'center'}
      ],
      getmockai:[],
      mockai:[]
    };
  },
  computed:{
    user(){
      return this.$store.state.user
    }
  },
  created(){
    this.getMockai()
  },
  methods: {
    async getMockai() {
          try {
            const user_no=this.user.user_no;
            const response = await axios.get(`http://localhost:3000/mypage/mypagemk/${user_no}`);
            console.log(response.data)
            this.mockai = Object.entries(response.data)
            .map(([coin,info]) =>({
              coin:info.MOCK_NAME,
              price:info.MOCK_PRICE,
              amount:info.MOCK_AMOUNT,
              total_price:parseInt(info.MOCK_PRICE)*parseInt(info.MOCK_AMOUNT),
              sale_date:this.$formatDateTime(info.SALE_MOCK_DATE),
              sell_date:!info.SELL_DATE?'매도한 날짜가 없습니다.':this.$formatDateTime(info.SELL_DATE)
            }))
          } catch (error) {
            console.error(error);
          }
        },
    },
};
</script>
<style scoped>
table {
  border-collapse: separate;
  border-spacing: 0 10px;
  margin-top: -10px; /* correct offset on first border spacing if desired */
}

th {
  border: none !important;
  box-shadow: none !important;
}

td {
  padding: 20px;
  height: 60px !important;
}

td:first-child {
  border-left-style: solid;
  border-top-left-radius: 10px;
  border-bottom-left-radius: 10px;
}

td:last-child {
  border-right-style: solid;
  border-bottom-right-radius: 10px;
  border-top-right-radius: 10px;
}
</style>
